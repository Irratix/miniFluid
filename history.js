// compressed with https://xem.github.io/terser-online/

function e(e,a,r){this.posx=e,this.posy=a,this.wallflag=r,this.velx=0,this.vely=0,this.forcex=0,this.forcey=0,this.density=0}accuracy=1,Gravity=1,Pressure=3,Viscosity=4,w=79*accuracy,h=25*accuracy,scale=2;var a=[];canvas.width=w*scale,canvas.height=h*scale;var r=canvas.getContext("2d");previewarea.cols=w,previewarea.rows=h,init=()=>{a=[];for(var r=previewarea.value,s=0,t=0,c=0;c<r.length;c++){var i=r[c];if("\n"===i)s+=accuracy,t=0;else if(" "!==i){for(var o="#"===i,y=0;y<accuracy;y++)for(var l=0;l<accuracy;l++)a.push(new e(t+y,s+l,o));t+=accuracy}else t+=accuracy}},density=()=>{for(var e=0;e<a.length;e++){var r=a[e];r.density=r.wallflag?9:0;for(var s=0;s<a.length;s++){var t=a[s],c=r.posx-t.posx,i=r.posy-t.posy,o=c*c+i*i;if(o<4){var y=Math.sqrt(o)/2-1;r.density+=y*y}}}},force=()=>{for(var e=0;e<a.length;e++){var r=a[e];r.forcey=Gravity,r.forcex=0;for(var s=0;s<a.length;s++){var t=a[s],c=r.posy-t.posy,i=r.posx-t.posx,o=c*c+i*i;if(o<4){var y=Math.sqrt(o)/2-1;r.forcey+=(c*(3-r.density-t.density)*Pressure+r.vely*Viscosity-t.vely*Viscosity)*y/r.density,r.forcex+=(i*(3-r.density-t.density)*Pressure+r.velx*Viscosity-t.velx*Viscosity)*y/r.density}}}},draw=()=>{canvas.width^=0,r.fillStyle="#0008";for(var e=0;e<a.length;e++){var s=a[e],t=s.posx,c=s.posy;s.wallflag||(s.posy+=s.vely+=s.forcey/10,s.posx+=s.velx+=s.forcex/10),0<=t&&t<w&&0<=c&&c<h&&(r.beginPath(),r.arc(t*scale,c*scale,scale,0,7),r.fill())}},nextframe=()=>{density(),force(),draw()},fetch("inputs/endoh1.c").then(e=>e.text()).then(e=>{previewarea.value=e,init(),setInterval(nextframe,33)})

accuracy=1,Gravity=1,Pressure=3,Viscosity=4,w=79*accuracy,h=25*accuracy,scale=2;var e=[];canvas.width=w*scale,canvas.height=h*scale;var a=canvas.getContext("2d");previewarea.cols=w,previewarea.rows=h,init=()=>{e=[];for(var a=previewarea.value,r=0,s=0,c=0;c<a.length;c++){var t=a[c];if("\n"===t)r+=accuracy,s=0;else if(" "!==t){for(var o="#"===t,i=0;i<accuracy;i++)for(var y=0;y<accuracy;y++)e.push({posx:s+i,posy:r+y,wallflag:o,velx:0,vely:0,forcex:0,forcey:0,density:0});s+=accuracy}else s+=accuracy}},density=()=>{for(var a=0;a<e.length;a++){var r=e[a];r.density=r.wallflag?9:0;for(var s=0;s<e.length;s++){var c=e[s],t=r.posx-c.posx,o=r.posy-c.posy,i=t*t+o*o;if(i<4){var y=Math.sqrt(i)/2-1;r.density+=y*y}}}},force=()=>{for(var a=0;a<e.length;a++){var r=e[a];r.forcey=Gravity,r.forcex=0;for(var s=0;s<e.length;s++){var c=e[s],t=r.posy-c.posy,o=r.posx-c.posx,i=t*t+o*o;if(i<4){var y=Math.sqrt(i)/2-1;r.forcey+=(t*(3-r.density-c.density)*Pressure+r.vely*Viscosity-c.vely*Viscosity)*y/r.density,r.forcex+=(o*(3-r.density-c.density)*Pressure+r.velx*Viscosity-c.velx*Viscosity)*y/r.density}}}},draw=()=>{canvas.width^=0,a.fillStyle="#0008";for(var r=0;r<e.length;r++){var s=e[r],c=s.posx,t=s.posy;s.wallflag||(s.posy+=s.vely+=s.forcey/10,s.posx+=s.velx+=s.forcex/10),0<=c&&c<w&&0<=t&&t<h&&(a.beginPath(),a.arc(c*scale,t*scale,scale,0,7),a.fill())}},nextframe=()=>{density(),force(),draw()},fetch("inputs/endoh1.c").then(e=>e.text()).then(e=>{previewarea.value=e,init(),setInterval(nextframe,33)})